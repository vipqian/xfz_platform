function AddCourse(){}AddCourse.prototype.initUEditor=function(){window.ue=UE.getEditor("editor",{initialFrameHeight:400,serverUrl:"/ueditor/upload/"})},AddCourse.prototype.listenQnUploadFileEvent=function(){var i=this,e=$("#thumbnail-btn");e.change(function(){var s=e[0].files[0];xfzajax.get({url:"/cms/qntoken",success:function(e){if(200===e.code){var o=e.data.token,t=(new Date).getTime()+"."+s.name.split(".")[1],r={fname:t,params:{},mimeType:["image/png","video/x-ms-wmv","image/jpeg"]},n={useCdnDomain:!0,retryCount:6,region:qiniu.region.z2};qiniu.upload(s,t,o,r,n).subscribe({next:i.updateUploadProgress,error:i.uploadErrorEvent,complete:i.complateUploadEvent})}}})})},AddCourse.prototype.updateUploadProgress=function(e){var o=e.total.percent;AddCourse.progressGroup.show();var t=$(".progress-bar"),r=o.toFixed(0)+"%";t.css({width:r}),t.text(r)},AddCourse.prototype.uploadErrorEvent=function(e){AddCourse.progressGroup.hide(),"file type doesn't match with what you specify"===e.message&&window.messageBox.show("上传的文件不匹配")},AddCourse.prototype.complateUploadEvent=function(e){AddCourse.progressGroup.hide();var o=$(".progress-bar");o.css({width:0}),o.text("0%");var t="http://ps9lpfh8q.bkt.clouddn.com/"+e.key;$("#thumbnail-form").val(t)},AddCourse.prototype.listenSumbitEvent=function(){$("#sub-btn").click(function(e){e.preventDefault();var o=$("input[name='title']").val(),t=$("select[name='category']").val(),r=$("select[name='teacher']").val(),n=$("input[name='voideUrl']").val(),s=$("input[name='coverUrl']").val(),i=$("input[name='price']").val(),a=$("input[name='duration']").val(),u=window.ue.getContent();console.log(i),xfzajax.post({url:"/cms/add_course/",data:{title:o,category:t,teacher:r,video_url:n,cover_url:s,price:i,duration:a,profile:u},success:function(e){if(console.log(e),200===e.code)window.messageBox.show("发布成功"),setTimeout(function(){window.location.href="http://127.0.0.1:8000/cms/course_list/"},3e3);else{var o=e.message;if("string"==typeof o||"String"==o.constructor)window.messageBox.show(e.message);else for(var t in o){var r=o[t][0];window.messageBox.show(r)}}}})})},AddCourse.prototype.listenUploadFileEvent=function(){var t=$("#thumbnail-btn");t.change(function(){var e=t[0].files[0],o=new FormData;o.append("file",e),xfzajax.post({url:"/cms/upload_file/",data:o,processData:!1,contentType:!1,success:function(e){200===e.code&&(url=e.data.url,$("#thumbnail-form").val(url))}})})},AddCourse.prototype.run=function(){this.initUEditor(),this.listenUploadFileEvent(),this.listenSumbitEvent()},$(function(){(new AddCourse).run(),AddCourse.progressGroup=$("#progress-group")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNtcy9jb3Vyc2UvYWRkX2NvdXJzZS5qcyJdLCJuYW1lcyI6WyJBZGRDb3Vyc2UiLCJwcm90b3R5cGUiLCJpbml0VUVkaXRvciIsIndpbmRvdyIsInVlIiwiVUUiLCJnZXRFZGl0b3IiLCJpbml0aWFsRnJhbWVIZWlnaHQiLCJzZXJ2ZXJVcmwiLCJsaXN0ZW5RblVwbG9hZEZpbGVFdmVudCIsInNlbGYiLCJ0aGlzIiwidXBsb2FkQnRuIiwiJCIsImNoYW5nZSIsImZpbGUiLCJmaWxlcyIsInhmemFqYXgiLCJnZXQiLCJ1cmwiLCJzdWNjZXNzIiwicmVzdWx0IiwidG9rZW4iLCJrZXkiLCJEYXRlIiwiZ2V0VGltZSIsIm5hbWUiLCJzcGxpdCIsInB1dEV4dHJhIiwiZm5hbWUiLCJwYXJhbXMiLCJtaW1lVHlwZSIsImNvbmZpZyIsInVzZUNkbkRvbWFpbiIsInJldHJ5Q291bnQiLCJyZWdpb24iLCJxaW5pdSIsInoyIiwidXBsb2FkIiwic3Vic2NyaWJlIiwibmV4dCIsInVwZGF0ZVVwbG9hZFByb2dyZXNzIiwiZXJyb3IiLCJ1cGxvYWRFcnJvckV2ZW50IiwiY29tcGxldGUiLCJjb21wbGF0ZVVwbG9hZEV2ZW50IiwicmVzcG9uc2UiLCJwZXJjZW50IiwidG90YWwiLCJwcm9ncmVzc0dyb3VwIiwic2hvdyIsInByb2dyZXNzQmFyIiwicHJvZ3Jlc3NUZXh0IiwidG9GaXhlZCIsImNzcyIsIndpZHRoIiwidGV4dCIsImhpZGUiLCJtZXNzYWdlIiwibWVzc2FnZUJveCIsImltZ1VybCIsInZhbCIsImxpc3RlblN1bWJpdEV2ZW50IiwiY2xpY2siLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidGl0bGUiLCJjYXRlZ29yeSIsInRlYWNoZXIiLCJ2aWRlb191cmwiLCJjb3Zlcl91cmwiLCJwcmljZSIsImR1cmF0aW9uIiwicHJvZmlsZSIsImdldENvbnRlbnQiLCJjb25zb2xlIiwibG9nIiwicG9zdCIsImRhdGEiLCJzZXRUaW1lb3V0IiwibG9jYXRpb24iLCJocmVmIiwibWVzc2FnZU9iamVjdCIsImNvbnN0cnVjdG9yIiwibGlzdGVuVXBsb2FkRmlsZUV2ZW50IiwiZnJvbURhdGEiLCJGb3JtRGF0YSIsImFwcGVuZCIsInByb2Nlc3NEYXRhIiwiY29udGVudFR5cGUiLCJydW4iXSwibWFwcGluZ3MiOiJBQUNBLFNBQVNBLGFBS1RBLFVBQVVDLFVBQVVDLFlBQWMsV0FDOUJDLE9BQU9DLEdBQUtDLEdBQUdDLFVBQVUsU0FBUyxDQUU5QkMsbUJBQXNCLElBRXRCQyxVQUFhLHNCQUlyQlIsVUFBVUMsVUFBVVEsd0JBQTBCLFdBQzFDLElBQUlDLEVBQU9DLEtBQ1BDLEVBQVlDLEVBQUUsa0JBQ2xCRCxFQUFVRSxPQUFPLFdBQ2IsSUFBSUMsRUFBT0gsRUFBVSxHQUFHSSxNQUFNLEdBQzlCQyxRQUFRQyxJQUFJLENBQ1JDLElBQU8sZUFDUEMsUUFBVyxTQUFVQyxHQUNqQixHQUF1QixNQUFuQkEsRUFBYSxLQUFVLENBQ3ZCLElBQUlDLEVBQVFELEVBQWEsS0FBUyxNQUM5QkUsR0FBTyxJQUFJQyxNQUFPQyxVQUFhLElBQU1WLEVBQUtXLEtBQUtDLE1BQU0sS0FBSyxHQUMxREMsRUFBVyxDQUVYQyxNQUFPTixFQUVQTyxPQUFRLEdBRVJDLFNBQVUsQ0FBQyxZQUFZLGlCQUFpQixlQUV4Q0MsRUFBUyxDQUVUQyxjQUFjLEVBRWRDLFdBQVksRUFFWkMsT0FBUUMsTUFBTUQsT0FBT0UsSUFFUkQsTUFBTUUsT0FBT3ZCLEVBQU1RLEVBQUtELEVBQU9NLEVBQVNJLEdBQzlDTyxVQUFVLENBRWpCQyxLQUFPOUIsRUFBSytCLHFCQUVaQyxNQUFRaEMsRUFBS2lDLGlCQUViQyxTQUFZbEMsRUFBS21DLDZCQVN6QzdDLFVBQVVDLFVBQVV3QyxxQkFBdUIsU0FBVUssR0FFakQsSUFFSUMsRUFEUUQsRUFBU0UsTUFDREQsUUFDQS9DLFVBQVVpRCxjQUNoQkMsT0FDZCxJQUFJQyxFQUFjdEMsRUFBRSxpQkFDaEJ1QyxFQUFlTCxFQUFRTSxRQUFRLEdBQUssSUFDeENGLEVBQVlHLElBQUksQ0FBQ0MsTUFBU0gsSUFDMUJELEVBQVlLLEtBQUtKLElBSXJCcEQsVUFBVUMsVUFBVTBDLGlCQUFtQixTQUFVRCxHQUN6QjFDLFVBQVVpRCxjQUNoQlEsT0FDUSxrREFBbEJmLEVBQU1nQixTQUNOdkQsT0FBT3dELFdBQVdULEtBQUssYUFLL0JsRCxVQUFVQyxVQUFVNEMsb0JBQXNCLFNBQVVDLEdBQzVCOUMsVUFBVWlELGNBQ2hCUSxPQUNkLElBQUlOLEVBQWN0QyxFQUFFLGlCQUNwQnNDLEVBQVlHLElBQUksQ0FBQ0MsTUFBUyxJQUMxQkosRUFBWUssS0FBSyxNQUVqQixJQUFJSSxFQUFTLG9DQUFxQ2QsRUFBU3ZCLElBQ3ZDVixFQUFFLG1CQUNSZ0QsSUFBSUQsSUFHdEI1RCxVQUFVQyxVQUFVNkQsa0JBQW9CLFdBQ3ZCakQsRUFBRSxZQUNSa0QsTUFBTSxTQUFVQyxHQUNuQkEsRUFBTUMsaUJBQ04sSUFBSUMsRUFBUXJELEVBQUUsdUJBQXVCZ0QsTUFDakNNLEVBQVd0RCxFQUFFLDJCQUEyQmdELE1BQ3hDTyxFQUFVdkQsRUFBRSwwQkFBMEJnRCxNQUN0Q1EsRUFBWXhELEVBQUUsMEJBQTBCZ0QsTUFDeENTLEVBQVl6RCxFQUFFLDBCQUEwQmdELE1BQ3hDVSxFQUFRMUQsRUFBRSx1QkFBdUJnRCxNQUNqQ1csRUFBVzNELEVBQUUsMEJBQTBCZ0QsTUFDdkNZLEVBQVV0RSxPQUFPQyxHQUFHc0UsYUFDeEJDLFFBQVFDLElBQUlMLEdBR1p0RCxRQUFRNEQsS0FBSyxDQUNUMUQsSUFBTyxtQkFDUDJELEtBQVEsQ0FDSlosTUFBU0EsRUFDVEMsU0FBWUEsRUFDWkMsUUFBWUEsRUFDWkMsVUFBYUEsRUFDYkMsVUFBYUEsRUFDYkMsTUFBU0EsRUFDVEMsU0FBWUEsRUFDWkMsUUFBV0EsR0FFZnJELFFBQVcsU0FBVUMsR0FFakIsR0FEQXNELFFBQVFDLElBQUl2RCxHQUNXLE1BQW5CQSxFQUFhLEtBQ2JsQixPQUFPd0QsV0FBV1QsS0FBSyxRQUN2QjZCLFdBQVcsV0FBVzVFLE9BQU82RSxTQUFTQyxLQUFLLDBDQUEyQyxTQUNwRixDQUNGLElBQUlDLEVBQWdCN0QsRUFBZ0IsUUFFcEMsR0FBNEIsaUJBQWpCNkQsR0FBMEQsVUFBN0JBLEVBQWNDLFlBQ2xEaEYsT0FBT3dELFdBQVdULEtBQUs3QixFQUFnQixjQUV2QyxJQUFLLElBQUlFLEtBQU8yRCxFQUFlLENBQzNCLElBQ0l4QixFQURXd0IsRUFBYzNELEdBQ04sR0FDdkJwQixPQUFPd0QsV0FBV1QsS0FBS1EsV0FTbkQxRCxVQUFVQyxVQUFVbUYsc0JBQXdCLFdBQ3hDLElBQUl4RSxFQUFZQyxFQUFFLGtCQUNsQkQsRUFBVUUsT0FBTyxXQUNiLElBQUlDLEVBQU9ILEVBQVUsR0FBR0ksTUFBTSxHQUMxQnFFLEVBQVcsSUFBSUMsU0FDbkJELEVBQVNFLE9BQU8sT0FBUXhFLEdBQ3hCRSxRQUFRNEQsS0FBSyxDQUNUMUQsSUFBTyxvQkFDUDJELEtBQVFPLEVBQ1JHLGFBQWUsRUFDZkMsYUFBZSxFQUNmckUsUUFBVyxTQUFVQyxHQUNNLE1BQW5CQSxFQUFhLE9BQ2JGLElBQU1FLEVBQWEsS0FBTyxJQUNQUixFQUFFLG1CQUNSZ0QsSUFBSTFDLFlBVXJDbkIsVUFBVUMsVUFBVXlGLElBQU0sV0FDdEIvRSxLQUFLVCxjQUVMUyxLQUFLeUUsd0JBQ0x6RSxLQUFLbUQscUJBSVRqRCxFQUFFLFlBQ2tCLElBQUliLFdBQ1YwRixNQUNWMUYsVUFBVWlELGNBQWdCcEMsRUFBRSIsImZpbGUiOiJjbXMvY291cnNlL2FkZF9jb3Vyc2UubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5mdW5jdGlvbiBBZGRDb3Vyc2UoKSB7XG5cbn1cblxuXG5BZGRDb3Vyc2UucHJvdG90eXBlLmluaXRVRWRpdG9yID0gZnVuY3Rpb24gKCkge1xuICAgIHdpbmRvdy51ZSA9IFVFLmdldEVkaXRvcignZWRpdG9yJyx7XG4gICAgICAgIC8vIOe8lui+keWZqOmrmOW6plxuICAgICAgICAnaW5pdGlhbEZyYW1lSGVpZ2h0JzogNDAwLFxuICAgICAgICAvLyDkvb/nlKjlm77niYfkuIrkvKBcbiAgICAgICAgJ3NlcnZlclVybCc6ICcvdWVkaXRvci91cGxvYWQvJ1xuICAgIH0pO1xufTtcblxuQWRkQ291cnNlLnByb3RvdHlwZS5saXN0ZW5RblVwbG9hZEZpbGVFdmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHVwbG9hZEJ0biA9ICQoJyN0aHVtYm5haWwtYnRuJyk7XG4gICAgdXBsb2FkQnRuLmNoYW5nZShmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBmaWxlID0gdXBsb2FkQnRuWzBdLmZpbGVzWzBdO1xuICAgICAgICB4ZnphamF4LmdldCh7XG4gICAgICAgICAgICAndXJsJzogJy9jbXMvcW50b2tlbicsXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCl7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IHJlc3VsdFsnZGF0YSddWyd0b2tlbiddO1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gKG5ldyBEYXRlKCkuZ2V0VGltZSgpKSArICcuJyArIGZpbGUubmFtZS5zcGxpdCgnLicpWzFdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHV0RXh0cmEgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmlofku7blkI1cbiAgICAgICAgICAgICAgICAgICAgICAgIGZuYW1lOiBrZXksXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDlhbbku5blj4LmlbBcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtczoge30sXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDpmZDliLbnmoTmlofku7bnsbvlnotcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pbWVUeXBlOiBbJ2ltYWdlL3BuZycsJ3ZpZGVvL3gtbXMtd212JywnaW1hZ2UvanBlZyddXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb25maWcgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyDmmK/lkKbliqDpgJ9cbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZUNkbkRvbWFpbjogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWksei0peWQjuS7juaWsOS4iuS8oOeahOasoeaVsFxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0cnlDb3VudDogNixcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOS4g+eJm+WcsOWMulxuICAgICAgICAgICAgICAgICAgICAgICAgcmVnaW9uOiBxaW5pdS5yZWdpb24uejJcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9ic2VydmFibGUgPSBxaW5pdS51cGxvYWQoZmlsZSwga2V5LCB0b2tlbiwgcHV0RXh0cmEsY29uZmlnKTtcbiAgICAgICAgICAgICAgICAgICAgb2JzZXJ2YWJsZS5zdWJzY3JpYmUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5LiK5Lyg5paH5Lu26L+H56iL5Lit5ZGK6K+J5L2g5LiK5Lyg5aSa5bCRXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5leHRcIjpzZWxmLnVwZGF0ZVVwbG9hZFByb2dyZXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5LiK5Lyg5paH5Lu25Ye6546w6ZSZ6K+vXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVycm9yXCI6c2VsZi51cGxvYWRFcnJvckV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8g5paH5Lu25LiK5Lyg5oiQ5Yqf55qE5Zue6LCD5Ye95pWwXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNvbXBsZXRlXCI6IHNlbGYuY29tcGxhdGVVcGxvYWRFdmVudFxuICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KVxufTtcblxuQWRkQ291cnNlLnByb3RvdHlwZS51cGRhdGVVcGxvYWRQcm9ncmVzcyA9IGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIC8vIOS4iuS8oOi/h+eoi+S4reWBmueahOS6i+aDhVxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgdG90YWwgPSByZXNwb25zZS50b3RhbDtcbiAgICB2YXIgcGVyY2VudCA9IHRvdGFsLnBlcmNlbnQ7XG4gICAgdmFyIHByb2dyZXNzR3JvdXAgPSBBZGRDb3Vyc2UucHJvZ3Jlc3NHcm91cDtcbiAgICBwcm9ncmVzc0dyb3VwLnNob3coKTtcbiAgICB2YXIgcHJvZ3Jlc3NCYXIgPSAkKCcucHJvZ3Jlc3MtYmFyJyk7XG4gICAgdmFyIHByb2dyZXNzVGV4dCA9IHBlcmNlbnQudG9GaXhlZCgwKSArICclJztcbiAgICBwcm9ncmVzc0Jhci5jc3Moeyd3aWR0aCc6IHByb2dyZXNzVGV4dH0pO1xuICAgIHByb2dyZXNzQmFyLnRleHQocHJvZ3Jlc3NUZXh0KTtcblxufTtcblxuQWRkQ291cnNlLnByb3RvdHlwZS51cGxvYWRFcnJvckV2ZW50ID0gZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgdmFyIHByb2dyZXNzR3JvdXAgPSBBZGRDb3Vyc2UucHJvZ3Jlc3NHcm91cDtcbiAgICBwcm9ncmVzc0dyb3VwLmhpZGUoKTtcbiAgICBpZiAoZXJyb3IubWVzc2FnZSA9PT0gJ2ZpbGUgdHlwZSBkb2VzblxcJ3QgbWF0Y2ggd2l0aCB3aGF0IHlvdSBzcGVjaWZ5Jyl7XG4gICAgICAgIHdpbmRvdy5tZXNzYWdlQm94LnNob3coJ+S4iuS8oOeahOaWh+S7tuS4jeWMuemFjScpO1xuICAgIH1cblxufTtcblxuQWRkQ291cnNlLnByb3RvdHlwZS5jb21wbGF0ZVVwbG9hZEV2ZW50ID0gZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgdmFyIHByb2dyZXNzR3JvdXAgPSBBZGRDb3Vyc2UucHJvZ3Jlc3NHcm91cDtcbiAgICBwcm9ncmVzc0dyb3VwLmhpZGUoKTtcbiAgICB2YXIgcHJvZ3Jlc3NCYXIgPSAkKCcucHJvZ3Jlc3MtYmFyJyk7XG4gICAgcHJvZ3Jlc3NCYXIuY3NzKHsnd2lkdGgnOiAwfSk7XG4gICAgcHJvZ3Jlc3NCYXIudGV4dCgnMCUnKTtcblxuICAgIHZhciBpbWdVcmwgPSAnaHR0cDovL3BzOWxwZmg4cS5ia3QuY2xvdWRkbi5jb20vJysgcmVzcG9uc2Uua2V5O1xuICAgIHZhciB0aHVtYm5haWxGcm9tID0gJCgnI3RodW1ibmFpbC1mb3JtJyk7XG4gICAgdGh1bWJuYWlsRnJvbS52YWwoaW1nVXJsKTtcbn07XG5cbkFkZENvdXJzZS5wcm90b3R5cGUubGlzdGVuU3VtYml0RXZlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHN1YkJ0biA9ICQoJyNzdWItYnRuJyk7XG4gICAgc3ViQnRuLmNsaWNrKGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB2YXIgdGl0bGUgPSAkKFwiaW5wdXRbbmFtZT0ndGl0bGUnXVwiKS52YWwoKTtcbiAgICAgICAgdmFyIGNhdGVnb3J5ID0gJChcInNlbGVjdFtuYW1lPSdjYXRlZ29yeSddXCIpLnZhbCgpO1xuICAgICAgICB2YXIgdGVhY2hlciA9ICQoXCJzZWxlY3RbbmFtZT0ndGVhY2hlciddXCIpLnZhbCgpO1xuICAgICAgICB2YXIgdmlkZW9fdXJsID0gJChcImlucHV0W25hbWU9J3ZvaWRlVXJsJ11cIikudmFsKCk7XG4gICAgICAgIHZhciBjb3Zlcl91cmwgPSAkKFwiaW5wdXRbbmFtZT0nY292ZXJVcmwnXVwiKS52YWwoKTtcbiAgICAgICAgdmFyIHByaWNlID0gJChcImlucHV0W25hbWU9J3ByaWNlJ11cIikudmFsKCk7XG4gICAgICAgIHZhciBkdXJhdGlvbiA9ICQoXCJpbnB1dFtuYW1lPSdkdXJhdGlvbiddXCIpLnZhbCgpO1xuICAgICAgICB2YXIgcHJvZmlsZSA9IHdpbmRvdy51ZS5nZXRDb250ZW50KCk7XG4gICAgICAgIGNvbnNvbGUubG9nKHByaWNlKTtcblxuXG4gICAgICAgIHhmemFqYXgucG9zdCh7XG4gICAgICAgICAgICAndXJsJzogJy9jbXMvYWRkX2NvdXJzZS8nLFxuICAgICAgICAgICAgJ2RhdGEnOiB7XG4gICAgICAgICAgICAgICAgJ3RpdGxlJzogdGl0bGUsXG4gICAgICAgICAgICAgICAgJ2NhdGVnb3J5JzogY2F0ZWdvcnksXG4gICAgICAgICAgICAgICAgJ3RlYWNoZXInOiAgdGVhY2hlcixcbiAgICAgICAgICAgICAgICAndmlkZW9fdXJsJzogdmlkZW9fdXJsLFxuICAgICAgICAgICAgICAgICdjb3Zlcl91cmwnOiBjb3Zlcl91cmwsXG4gICAgICAgICAgICAgICAgJ3ByaWNlJzogcHJpY2UsXG4gICAgICAgICAgICAgICAgJ2R1cmF0aW9uJzogZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgJ3Byb2ZpbGUnOiBwcm9maWxlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KCflj5HluIPmiJDlip8nKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe3dpbmRvdy5sb2NhdGlvbi5ocmVmPVwiaHR0cDovLzEyNy4wLjAuMTo4MDAwL2Ntcy9jb3Vyc2VfbGlzdC9cIjt9LDMwMDApXG4gICAgICAgICAgICAgICAgfWVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZU9iamVjdCA9IHJlc3VsdFsnbWVzc2FnZSddO1xuICAgICAgICAgICAgICAgICAgICAvL+WIpOaWreaYr+S4jeaYr+Wtl+espuS4slxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2VPYmplY3QgPT0gXCJzdHJpbmdcIiB8fCBtZXNzYWdlT2JqZWN0LmNvbnN0cnVjdG9yID09ICdTdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93KHJlc3VsdFsnbWVzc2FnZSddKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBtZXNzYWdlT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gbWVzc2FnZU9iamVjdFtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KTtcbn07XG5cbkFkZENvdXJzZS5wcm90b3R5cGUubGlzdGVuVXBsb2FkRmlsZUV2ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciB1cGxvYWRCdG4gPSAkKCcjdGh1bWJuYWlsLWJ0bicpO1xuICAgIHVwbG9hZEJ0bi5jaGFuZ2UoZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZmlsZSA9IHVwbG9hZEJ0blswXS5maWxlc1swXTtcbiAgICAgICAgdmFyIGZyb21EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIGZyb21EYXRhLmFwcGVuZCgnZmlsZScsIGZpbGUpO1xuICAgICAgICB4ZnphamF4LnBvc3Qoe1xuICAgICAgICAgICAgJ3VybCc6ICcvY21zL3VwbG9hZF9maWxlLycsXG4gICAgICAgICAgICAnZGF0YSc6IGZyb21EYXRhLFxuICAgICAgICAgICAgJ3Byb2Nlc3NEYXRhJzogZmFsc2UsXG4gICAgICAgICAgICAnY29udGVudFR5cGUnOiBmYWxzZSxcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHVybCA9IHJlc3VsdFsnZGF0YSddWyd1cmwnXTtcbiAgICAgICAgICAgICAgICAgICB2YXIgdGh1bWJuYWlsRnJvbSA9ICQoJyN0aHVtYm5haWwtZm9ybScpO1xuICAgICAgICAgICAgICAgICAgIHRodW1ibmFpbEZyb20udmFsKHVybClcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgIH0pXG59O1xuXG5cbkFkZENvdXJzZS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuaW5pdFVFZGl0b3IoKTtcbiAgICAvLyB0aGlzLmxpc3RlblFuVXBsb2FkRmlsZUV2ZW50KCk7XG4gICAgdGhpcy5saXN0ZW5VcGxvYWRGaWxlRXZlbnQoKTtcbiAgICB0aGlzLmxpc3RlblN1bWJpdEV2ZW50KCk7XG59O1xuXG5cbiQoZnVuY3Rpb24gKCkge1xuICAgIHZhciBhZGRDb3Vyc2UgPSBuZXcgQWRkQ291cnNlKCk7XG4gICAgYWRkQ291cnNlLnJ1bigpO1xuICAgIEFkZENvdXJzZS5wcm9ncmVzc0dyb3VwID0gJCgnI3Byb2dyZXNzLWdyb3VwJyk7XG59KTtcblxuXG4iXX0=
